sudo: required

language: php

php:
  - 7
  
matrix:
  fast_finish: true
  
services:
  - beanstalkd
  - mongodb
  - redis-server
  - rabbitmq-server
  
addons:
  apt:
    sources:
    - mongodb-3.0-precise
    packages:
    - mongodb-org-server
    
before_script:
  - sudo apt-get install beanstalkd 
  - pecl install mongodb
  - if [[ $TRAVIS_PHP_VERSION =~ (^7|^nightly) ]]; then wget https://github.com/nicolasff/phpredis/archive/php7.zip && unzip php7.zip && cd phpredis-php7 && phpize && ./configure && make && make install; fi
  - travis_retry composer clearcache
  - travis_retry composer self-update
  - travis_retry composer install --no-interaction

script: 
  - php vendor/bin/phpunit --coverage-text

branches:
  only:
    - master
 
