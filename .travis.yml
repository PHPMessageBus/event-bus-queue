sudo: required

language: php

php:
  - 7
  
matrix:
  fast_finish: true
  
services:
  - beanstalkd
  - mongodb
  - redis-server
  - rabbitmq-server
  
addons:
  apt:
    sources:
    - mongodb-3.0-precise
    packages:
    - mongodb-org-server
    
before_script:
  - sudo apt-get install beanstalkd 
  - pecl install mongodb
  - if [[ $TRAVIS_PHP_VERSION =~ (^7|^nightly) ]]; then wget https://github.com/nicolasff/phpredis/archive/php7.zip && unzip php7.zip && cd phpredis-php7 && phpize && ./configure && make && make install; cd ..; echo "extension=redis.so" > /etc/php/7.0/cli/conf.d/redis.ini; fi
  - curl -sS https://getcomposer.org/installer | php -- --filename=composer
  - chmod +x composer
  - composer install

script: 
  - php vendor/bin/phpunit --coverage-text

branches:
  only:
    - master
 
